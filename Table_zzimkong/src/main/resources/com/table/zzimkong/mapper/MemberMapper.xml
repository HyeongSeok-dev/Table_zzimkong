<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.table.zzimkong.mapper.MemberMapper">

<!-- 일반회원가입 [INSERT] -->
<insert id="insertMember">
	INSERT 
	INTO user
	VALUES (

		null
		, #{user_id}
		, #{user_passwd}
		, #{user_nick}
		, CONCAT(#{user_email1}, '@', #{user_email2})
		, #{user_name}
		, #{user_birth}
		, #{com_num}
		, now()
		, #{user_phone}
		, 1
		, 1
		, 1
		, #{user_category}
		)
	
</insert>

<!-- 업주회원가입 [INSERT] -->
<insert id="insertCeoMember">
	INSERT 
	INTO user
	VALUES (

		null
		, #{user_id}
		, #{user_passwd}
		, #{user_nick}
		, CONCAT(#{user_email1}, '@', #{user_email2})
		, #{user_name}
		, #{user_birth}
		, #{com_num}
		, now()
		, #{user_phone}
		, 1
		, 1
		, 2
		, #{user_category}
		)
	
</insert>

<!-- 회원 아이디정보 조회 select -->
<select id="selectMember"  resultType="member">
	SELECT *
	FROM user
	<where>
		<if test="user_id != null">
			and user_id = #{user_id}
	 	</if>
	 	
		<if test="user_id == null and user_nick != null">
			and user_nick = #{user_nick}
	 	</if>
	 	
		<if test="user_id == null and user_email1 != null">
			and user_email = CONCAT(#{user_email1},'@',#{user_email2})
	 	</if>
	
	</where>
</select>

<!-- 회원탈퇴 -->
<update id="updateWithdrawMember">
	UPDATE user
    SET
         user_status=3
         , user_reg_date = now()
    WHERE user_id = #{user_id}
		
</update>

</mapper>